# Sudoku 公開向け 要件定義（現行 00_計算ロジック解析）

対象: `/Users/koki_naka/dev/codex-sandbox/sudoku/00_計算ロジック`

## 目的・スコープ
- 数独の盤面入力・検算・ヒント提示・解答をブラウザ上で提供し、学習/補助ツールとして公開する。
- 提供物は静的な HTML/CSS/JS の単一ページアプリ（サーバ処理なし）。
- 公開元は `sudoku` 直下（GitHub Pages で静的配信）。

## 機能要件（UI/操作）
- 9x9 盤面を入力できる（1セル1桁、数字以外は無視）。
- 盤面は「固定（given/黒）」「手入力（manual/青 or 黒）」「ソルバ入力（auto/赤）」の区別表示。
- ヒント操作は 1手だけ盤面に反映し、理由説明を表示する（ヒント適用マスは緑表示）。
- 矛盾盤面ではヒント操作を実行できない。
- Undo/Redo により盤面状態を履歴管理できる。
- 矛盾チェック（行・列・3x3 で重複があるか）を実行できる。
- 全消去、例題ロード、入出力（81文字: 0=空欄）を提供する。
- 手入力色をセレクトで切替できる。
- 行・列・ブロックの合計値（45判定）を常時表示し、OK/警告/矛盾の色分けを行う。

## 機能要件（入出力仕様）
- 入力: 81文字の文字列（数字・`.`）。`.` は `0` に変換。
- 出力: 81文字（空欄は `0`）。
- 例題: 固定文字列の問題をロード。

## ヒント機能（ロジック要件）
- 候補計算に基づき、以下の順に 1手ヒントを探索して提示する。
  1. Hidden Single（行→列→ブロック）
  2. Naked Single
  3. Locked Candidates（Pointing/Claiming）
  4. Naked/Hidden Pair
  5. Naked/Hidden Triple
  6. X-Wing
  7. Swordfish
  8. Y-Wing
  9. Naked/Hidden Quad
- ヒントは「除去の結果として新たに Naked Single が生じた場合」も 1手として提示する。
- 理由説明文は手筋ごとにテンプレート生成し、HTMLで表示する。

## 解答機能（ソルバ要件）
- バックトラッキングによる完全解答。
- 先に矛盾検証を行い、矛盾があれば停止する。
- 解けた場合はソルバが埋めた数字を `auto`（赤）として表示する。

## 検算表示（合計UI要件）
- 行・列・ブロックの合計値を表示する。
- OK条件: 合計=45 かつ 9マス入力済み かつ 重複なし。
- 警告条件: 未完成（合計<45 または 9マス未入力）。
- 矛盾条件: 合計>45 または 重複あり。

## 技術要件
- 依存: すべてプレーンJS（`window.SudokuCore` 等のグローバル）。
- スクリプトロード順が機能要件（`index.html` に明示）。
- モダンブラウザで動作（`structuredClone` は fallback あり）。
- 画面サイズに応じた簡易レスポンシブ（520px以下でセルサイズ縮小）。

## 非機能要件
- 静的ホスティングで動作（GitHub Pages想定）。
- ネットワーク通信なし。
- データ永続化なし（リロードで初期化）。
- 日本語UI。

## 疑問点・要確認事項
- 公開用の使い方/用語説明/手筋一覧をUI内に入れるか、別ページにするか。
- ライセンス・クレジット表示の要否。
