# 数独画像取り込み（クライアント内OCR）要件定義

対象: `/Users/koki_naka/dev/codex-sandbox/sudoku` の公開版に追加する新機能
方針: 端末内OCR（外部APIなし、ネットワーク通信なし）

## 目的・スコープ
- スマホ/PCで撮影した数独画像をアップロードし、盤面に自動反映する。
- 画像は外部送信せず、ブラウザ内で解析する。
- 精度は「完全自動」ではなく、ユーザーが結果を確認・補正できることを前提とする。

## ユースケース
- ユーザーが写真を選択すると、盤面候補が自動入力される。
- 誤認識がある場合は、手入力で簡単に修正できる。

## 画面・操作要件
- 「画像取り込み」ボタンを追加（`<input type="file">` またはドラッグ&ドロップ）。
- 取り込み中は進行表示（「解析中…」）を表示。
- 取り込み結果は即時に盤面へ反映する（プレビュー/確認ステップなし）。
- 取り込み結果は黒表示（OCR）で反映し、セルは編集可能にする（既存盤面は上書き）。
- 読み取り失敗時はメッセージ表示し、入力済み盤面は破壊しない。

## OCR・解析要件
- OCRライブラリはクライアント内で動作するものを使用する（Tesseract.js を採用）。
- 画像前処理（グレースケール化、二値化、回転補正、コントラスト強調）を行う。
- 盤面の外枠を検出し、9x9グリッドへ分割して各セルを識別する。
- 各セルの数字認識は 1〜9 を対象とし、空欄は 0 とする。
- OCR結果に信頼度スコアを付与し、低信頼セルはユーザーに注意表示する。

## 例外・エラーハンドリング
- 盤面枠が検出できない場合はエラー表示し、処理を終了する。
- 盤面サイズ/傾きが大きい場合は再撮影を促す。
- 解析時間が長い場合はキャンセルできる。

## 非機能要件
- 画像はブラウザ内でのみ処理し、ネットワーク通信なし。画像の保管は行わない。
- 処理は主要ブラウザ（Chrome/Safari/Edge）で動作する。
- 大きな画像でも実用的な時間で処理できること（目安: 3〜8秒）。

## 追加確認事項
- OCRライブラリの導入コスト（bundleサイズと初回ロード時間の許容範囲）
